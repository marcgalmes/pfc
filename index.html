<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Incidencias - Ayuntamiento de Foobar</title>
  <style>
	  @import url(https://fonts.googleapis.com/css?family=Raleway:300,700);
	  body {
		  background: #fafafa;
		  color: #555;
		  font-family: 'Raleway', Helvetica, Arial, sans-serif;
		  font-size: 20px;
		  font-weight: 300;
		  margin: 0;
		  min-height: 100vh;
		  padding: 0;
		  text-align: center;
		  width: 100%;
	  }

	  body .burger_box .menu-icon_line {
		  background: #060606;
	  }
	  body .side_menu {
		  background: #fafafa;
		  font-size: 14px;
		  z-index: 2;
	  }
	  body .side_menu .list_item a{
		  color: #000;
	  }
	  body .burger_box a.menu-icon.opened {
		  background-color: #fafafa;
	  }
	  body .list_item a:hover {
		  background: rgba(0,0,0,.2);
	  }
	  
	  body .menu {
		padding: 0px;
		font-size: 14px;
	  }
	  
	  #mapa {
		max-width: 100%;
		width: 100%;
        height: 70vh;
        background-color: grey;
	  }
  </style>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC24GO81Fb-gw3SzEpSGxy_d3oV4r3jiew&callback=initMap"></script>	
  
      <link rel="stylesheet" href="buttons.css">
      <link rel="stylesheet" href="side-menu.css">
	<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
	<script src="side-menu.js"></script>
	<script>
	     // Note: This example requires that you consent to location sharing when
      // prompted by your browser. If you see the error "The Geolocation service
      // failed.", it means you probably did not give permission for the browser to
      // locate you.
var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('mapa'), {
          center: {lat: 39.5687965, lng: 2.6673537},
          zoom: 16
        });
        var infoWindow = new google.maps.InfoWindow({map: map});

        // Try HTML5 geolocation.
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            var image = 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png';
            var pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

             var marker1 = new google.maps.Marker({
          position: pos,
          map: map,
                draggable: true,
               icon: image,
          animation: google.maps.Animation.DROP,
          title: 'Tu ubicación'
               
        });
            poly = new google.maps.Polyline({
          strokeColor: '#000000',
          strokeOpacity: 1.0,
          strokeWeight: 3
        });
        poly.setMap(map);
            
            
            infoWindow.setPosition(pos);
            infoWindow.setContent('Location found.');
            map.setCenter(pos);
             map.addListener('click', addLatLng);
            marker1.addListener('click', function() {
          map.setZoom(18);
          map.setCenter(marker1.getPosition());
        });
          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }
      }

      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
      }

function addLatLng(event) {
        var path = poly.getPath();

        // Because path is an MVCArray, we can simply append a new coordinate
        // and it will automatically appear.
        path.push(event.latLng);

        // Add a new marker at the new plotted point on the polyline.
        var marker = new google.maps.Marker({
          position: event.latLng,
          title: '#' + path.getLength(),
          map: map
        });
      }
	</script>

  
</head>

<body>
<div class="side_menu">
	<div class="burger_box">
		<div class="menu-icon-container">
			<a href="#" class="menu-icon js-menu_toggle closed">
				<span class="menu-icon_box">
					<span class="menu-icon_line menu-icon_line--1"></span>
					<span class="menu-icon_line menu-icon_line--2"></span>
					<span class="menu-icon_line menu-icon_line--3"></span>
				</span>
			</a>
		</div>
	</div>
	<div class="container">
		<h2 class="menu_title">Menu</h2>
		<ul class="list_load">
			<li class="list_item"><a href="#">Mapa de incidencias</a></li>
			<li class="list_item"><a href="#">Incidencias recientes</a></li>
			<li class="list_item"><a href="#">List Item 03</a></li>
			<li class="list_item"><a href="#">List Item 04</a></li>
			<li class="list_item"><a href="#">List Item 05</a></li>
			<li class="list_item"><a href="#">List Item 06</a></li>
			<li class="list_item"><a href="#">List Item 07</a></li>
			<li class="list_item"><a href="#">List Item 08</a></li>
		</ul>
		<div class="spacer_box"><p>This is a spacer box.</p></div>
	</div>
</div>
<div class="content">
	<h5 class="what_to_do">Mapa de incidencias</h5>

	<div id="mapa"></div>
	<div class="menu effect-13">
		<ul>
			<li><a href="#mapa">Mi ubicación</a></li>
			<li><a href="#mapa">Nueva incidencia</a></li>
			<li><a href="#">Button</a></li>
			<li><a href="#">Button</a></li>
		</ul>
	</div>
	<h5 class="what_to_do">Incidencias recientes:</h5>

</div>


</body>

</html>
